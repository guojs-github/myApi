var myApi;$(function(){window.onpageshow=function(e){e.persisted&&window.location.reload()}}),(myApi=myApi||{}).browser={clientHeight:function(){return console.log("Get browser height."),window.innerHeight}},(myApi=myApi||{}).common={queryString:function(e){console.log("Get query string."),console.log("key:"+e);var o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(o),n="";return null!=t&&(n=t[2]),(t=o=null)==n||""==n||"undefined"==n?"":n},checkMobile:function(e){return console.log("Check mobile phone number."),console.log("value:"+e),/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e)},stopBubble:function(e){console.log("Stop bubble"),e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0}},(myApi=myApi||{}).number={formatAmount:function(e,o){var t=e;if(e<0&&(e=0-e),/[^0-9\.]/.test(e))return"0.00";if(null==e||"null"==e||""==e)return"0.00";0<o&&(e=new Number(e).toFixed(o)),e=(e=((e=e.toString().replace(/^(\d*)$/,"$1."))+"00").replace(/(\d*\.\d\d)\d*/,"$1")).replace(".",",");for(var n=/(\d)(\d{3},)/;n.test(e);)e=e.replace(n,"$1,$2");if(e=e.replace(/,(\d\d)$/,".$1"),0==o){var i=e.split(".");"00"==i[1]&&(e=i[0])}return t=t<0?"("+e+")":e}},(myApi=myApi||{}).request={requestTimeout:1e4,post:function(e,o,t,n,i){console.log("Send a post request."),console.log("url:"+e),console.log("param:"+JSON.stringify(o));var l=this.requestTimeout;"number"==typeof i&&0<i&&(l=i),myApi.interaction.loading.show();var c=$.ajax({url:e,type:"POST",data:JSON.stringify(o),cache:!1,timeout:l,dataType:"json",error:function(e,o,t){console.log("Request fail."),console.log("request:"+JSON.stringify(e)),console.log("status:"+JSON.stringify(o)),console.log("err:"+JSON.stringify(t)),"function"==typeof n&&n(e,o,t)},success:function(e){console.log("Request success"),console.log("data:"+JSON.stringify(e)),"function"==typeof t&&t(e)},complete:function(e,o){myApi.interaction.loading.hide(),"timeout"==o&&c.abort()}})},get:function(e,o,n,t){console.log("Send a get request."),console.log("url:"+e);var i=this.requestTimeout;"number"==typeof t&&0<t&&(i=t),myApi.interaction.loading.show();var l=$.ajax({url:e,type:"GET",cache:!1,timeout:i,dataType:"json",error:function(e,o,t){console.log("Request fail."),console.log("request:"+JSON.stringify(e)),console.log("status:"+JSON.stringify(o)),console.log("err:"+JSON.stringify(t)),"function"==typeof n&&n(e,o,t)},success:function(e){console.log("Request success"),console.log("data:"+JSON.stringify(e)),"function"==typeof o&&o(e)},complete:function(e,o){myApi.interaction.loading.hide(),"timeout"==o&&l.abort()}})}},(myApi=myApi||{}).storage={setItem:function(e,o){console.log("Local storage set item."),console.log("key:"+e),console.log("value:"+o);var t=window.localStorage;return"object"==typeof t&&null!=t&&(t.setItem(e,o),!0)},getItem:function(e){console.log("Local storage get item."),console.log("key:"+e);var o=window.localStorage;if("object"!=typeof o||null==o)return null;var t=o.getItem(e);return void 0===t||null==t?"":t}},(myApi=myApi||{}).time={formatDate:function(e,o){var t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),l=void 0===o?"-":o;return t+l+(n<10?"0"+n:n)+l+(i<10?"0"+i:i)},formatDateString:function(e,o){var t=void 0===o?"-":o;return 8!=e.length?"":e.substr(0,4)+t+e.substr(4,2)+t+e.substr(6,2)},addDays:function(e,o){var t=e.getTime(),n=new Date;return n.setTime(t+24*o*3600*1e3),n}},(myApi=myApi||{}).wx={init:function(e,o,t){console.log("Initialize wx api."),console.log("param:"+JSON.stringify(e));var n=!1;wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["chooseWXPay","chooseImage","uploadImage","scanQRCode"]}),wx.ready(function(){console.log("JSAPI ready."),0==n&&"function"==typeof o&&o()}),wx.error(function(e){console.log("JSAPI initialize fail."),n=!0,"function"==typeof t&&t()})},scan:function(o,t){console.log("Scan"),wx.checkJsApi({jsApiList:["scanQRCode"],success:function(e){if(console.log("res:"+JSON.stringify(e)),e.errMsg.indexOf("ok")<0)return console.log("Error occurred:"+e.errMsg),void("function"==typeof t&&t("扫描功能检测失败"));1==e.checkResult.scanQRCode?(console.log("Scan qr code allowed."),wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(e){if(console.log("scan res:"+JSON.stringify(e)),e.errMsg.indexOf("ok")<0)return console.log("Error occurred while scan:"+e.errMsg),void("function"==typeof t&&t("扫描功能未获授权"));console.log("scan success"),"function"==typeof o&&o(e.resultStr)}})):(console.log("Scan qr code no allowed."),"function"==typeof t&&t("扫描功能未获授权"))}})}},(myApi=myApi||{}).interaction=myApi.interaction||{},myApi.interaction.bill={init:function(){console.log("Initialize bill form."),$(".weui-tab__bd.bill-body").css("height",myApi.browser.clientHeight()-60+"px"),$(".weui-tab__bd.bill-body .weui-tab__bd-item").css("height",myApi.browser.clientHeight()-60+"px"),$(".weui-tab__bd.bill-body .weui-tab__bd-item.list").css("height",myApi.browser.clientHeight()-60-50+"px")}},$(function(){console.log("bill form ready!"),myApi.interaction.bill.init()}),(myApi=myApi||{}).interaction=myApi.interaction||{},myApi.interaction.critical={show:function(e){console.log("Show critical message."),console.log("message:"+e);try{document.body.removeChild(document.querySelector("div.critical-message"))}catch(e){}var o=document.createElement("div");o.classList.add("critical-message"),o.classList.add("mask"),o.classList.add("flex-column");var t=document.createElement("div");t.classList.add("dialog"),t.classList.add("flex-column");var n=document.createElement("div");n.classList.add("dialog-title"),n.innerText="提示",t.appendChild(n);var i=document.createElement("div");i.classList.add("dialog-content"),i.innerText="这是样例信息","string"==typeof e&&0<e.trim().length&&(i.innerText=e),t.appendChild(i),o.appendChild(t),document.body.appendChild(o)}},(myApi=myApi||{}).interaction=myApi.interaction||{},myApi.interaction.input={show:function(e,o,t){console.log("Show input dialog.");var n=this;try{document.body.removeChild(document.querySelector("div.input-dialog"))}catch(e){}var i=document.createElement("div");i.classList.add("input-dialog"),i.classList.add("mask"),i.classList.add("flex-column");var l=document.createElement("div");l.classList.add("dialog"),l.classList.add("flex-column");var c=document.createElement("div");c.classList.add("dialog-title"),"string"==typeof e.title&&0<e.title.trim().length?c.innerText=e.title:c.innerText="请输入",l.appendChild(c);var a=document.createElement("textarea");a.classList.add("dialog-textarea"),"number"==typeof e.maxLength&&0<e.maxLength&&a.setAttribute("maxlength",e.maxLength),l.appendChild(a);var s=document.createElement("div");s.classList.add("dialog-button-bar");var r=document.createElement("div");r.classList.add("dialog-button"),r.classList.add("dialog-button-cancel"),r.classList.add("dialog-button-left"),r.innerText="取消",r.style.width="50%",r.onclick=function(){n.hide(),"function"==typeof t&&t()},s.appendChild(r);var d=document.createElement("div");d.classList.add("dialog-button"),d.classList.add("dialog-button-ok"),d.classList.add("dialog-button-right"),d.innerText="确认",d.style.width="50%",d.onclick=function(){n.hide();var e=a.value;console.log("content:"+e),"function"==typeof o&&o(e)},s.appendChild(d),l.appendChild(s),i.appendChild(l),document.body.appendChild(i)},hide:function(){console.log("Hide input dialog.");try{document.body.removeChild(document.querySelector("div.input-dialog"))}catch(e){}}},(myApi=myApi||{}).interaction=myApi.interaction||{},myApi.interaction.loading={show:function(){console.log("Show loading.");try{document.body.removeChild(document.querySelector("div.loading"))}catch(e){}var e=document.createElement("div");e.classList.add("loading"),document.body.appendChild(e)},hide:function(){console.log("Hide loading.");try{document.body.removeChild(document.querySelector("div.loading"))}catch(e){}}},(myApi=myApi||{}).interaction=myApi.interaction||{},myApi.interaction.other={hintNoMore:function(){console.log("Show no more hint"),$(".weui-loading").css("display","none"),$(".weui-loadmore__tips").text("-- 没有更多了 --")},hintLoading:function(){console.log("Show loading hint"),$(".weui-loading").css("display",""),$(".weui-loadmore__tips").text("-- 拼命加载中 --")}};