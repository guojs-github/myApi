if("undefined"==typeof jQuery)throw new Error("myApi: This plugin requires jQuery");var myApi;$(function(){console.log("myApi loading."),myApi.string.init()}),(myApi=myApi||{}).browser={BROWSER_TYPE:{UNKNOWN:"Unknown",OPERA:"Opera",FIREFOX:"Firefox",CHROME:"Chrome",SAFARI:"Safari",EDGE:"Edge",WEIXIN:"Weixin",IE:"IE"},type:function(){console.log("Browser type");var e=navigator.userAgent,o=-1<e.indexOf("Opera"),t=-1<e.indexOf("compatible")&&-1<e.indexOf("MSIE")&&!o,n=-1<e.indexOf("Trident")&&-1<(-1<e.indexOf("rv"))&&!t,i=-1<e.indexOf("Edge")&&!n,r=-1<e.toLowerCase().indexOf("micromessenger"),s=-1<e.indexOf("Firefox"),l=-1<e.indexOf("Safari")&&-1==e.indexOf("Chrome")&&!r,c=-1<e.indexOf("Chrome")&&-1<e.indexOf("Safari")&&!r,a=null;try{return t?(new RegExp("MSIE (\\d+\\.\\d+);").test(e),7<=(a=parseFloat(RegExp.$1))&&a<=11?this.BROWSER_TYPE.IE+a:this.BROWSER_TYPE.IE):n?this.BROWSER_TYPE.IE+"11":i?this.BROWSER_TYPE.EDGE:o?this.BROWSER_TYPE.OPERA:s?this.BROWSER_TYPE.FIREFOX:l?this.BROWSER_TYPE.SAFARI:c?this.BROWSER_TYPE.CHROME:r?this.BROWSER_TYPE.WEIXIN:this.BROWSER_TYPE.UNKNOWN}catch(e){throw e}finally{a=c=l=s=i=t=o=e=null}},isIE:function(){console.log("Is ie browser?");var e=this.type();try{return-1<e.indexOf(this.BROWSER_TYPE.IE)}catch(e){throw e}finally{e=null}},availHeight:function(){var e=40,o=0;try{return this.type(),this.isIE()?(o=108,screen.availHeight-o):(this.BROWSER_TYPE.CHROME,o=90,screen.availHeight-e-o)}catch(e){throw e}finally{o=e=null}},language:function(){console.log("Get browser language");var e=this.type(),o="en";try{return-1<e.indexOf(this.BROWSER_TYPE.IE)?window.navigator.userLanguage.toLowerCase():window.navigator.language.toLowerCase()}catch(e){return o}finally{o=e=null}},isChinese:function(){return console.log("The language is chinese?"),"zh-cn"==this.language()}},(myApi=myApi||{}).common={queryString:function(e){console.log("Get query string."),console.log("key:"+e);var o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),t=window.location.search.substr(1).match(o),n="";return null!=t&&(n=t[2]),(t=o=null)==n||""==n||"undefined"==n?"":n},checkMobile:function(e){return console.log("Check mobile phone number."),console.log("value:"+e),/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(e)},stopBubble:function(e){console.log("Stop bubble"),e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0}},(myApi=myApi||{}).cookie=new function(){var t="/",n=function(){var e={},o=document.cookie;if(console.log("cookie:"+o),""===o)return e;for(var t=o.split("; "),n=0;n<t.length;n++){var i=t[n],r=i.indexOf("="),s=i.substring(0,r),l=i.substring(r+1);l=decodeURIComponent(l),e[s]=l}return e}();var i=[];for(var e in n)i.push(e);this.length=i.length,this.key=function(e){return console.log("Get specified cookie;"),console.log("n:"+e),e<0||e>=i.length?null:i[e]},this.setItem=function(e,o){console.log("Set cookie."),console.log("key:"+e),console.log("value:"+o),e in n||(i.push(e),this.length++),n[e]=o;var t=e+"="+encodeURIComponent(o);t+="; max-age="+864e5,t+="; path=/",document.cookie=t},this.getItem=function(e){return console.log("Get cookie."),console.log("key:"+e),void 0===n[e]||null==n[e]?"":n[e]},this.removeItem=function(e){if(console.log("Remove cookie."),console.log("key:"+e),e in n){delete n[e];for(var o=0;o<i.length;o++)if(i[o]===e){i.splice(o,1);break}this.length--,document.cookie=e+"=; max-age=0; path="+t}},this.clear=function(){console.log("Clear cookie.");for(var e=0;e<i.length;e++)document.cookie=i[e]+"=; max-age=0; path="+t;n={},i=[],this.length=0}},(myApi=myApi||{}).number={formatAmount:function(e,o){var t=e;if(e<0&&(e=0-e),/[^0-9\.]/.test(e))return"0.00";if(null==e||"null"==e||""==e)return"0.00";0<o&&(e=new Number(e).toFixed(o)),e=(e=((e=e.toString().replace(/^(\d*)$/,"$1."))+"00").replace(/(\d*\.\d\d)\d*/,"$1")).replace(".",",");for(var n=/(\d)(\d{3},)/;n.test(e);)e=e.replace(n,"$1,$2");if(e=e.replace(/,(\d\d)$/,".$1"),0==o){var i=e.split(".");"00"==i[1]&&(e=i[0])}return t=t<0?"("+e+")":e}},(myApi=myApi||{}).request={requestTimeout:3e3,post:function(e,o,t,n,i){console.log("Send a post request."),console.log("url:"+e),console.log("param:"+JSON.stringify(o));var r=this.requestTimeout;"number"==typeof i&&0<i&&(r=i),myApi.display.loading.show();var s=$.ajax({url:e,type:"POST",data:JSON.stringify(o),cache:!1,timeout:r,dataType:"json",error:function(e,o,t){console.log("Request fail."),console.log("request:"+JSON.stringify(e)),console.log("status:"+JSON.stringify(o)),console.log("err:"+JSON.stringify(t)),"function"==typeof n&&n(e,o,t)},success:function(e){console.log("Request success"),console.log("data:"+JSON.stringify(e)),"function"==typeof t&&t(e)},complete:function(e,o){myApi.display.loading.hide(),"timeout"==o&&s.abort()}})},get:function(e,o,n,t){console.log("Send a get request."),console.log("url:"+e);var i=this.requestTimeout;"number"==typeof t&&0<t&&(i=t),myApi.display.loading.show();var r=$.ajax({url:e,type:"GET",cache:!1,timeout:i,dataType:"json",error:function(e,o,t){console.log("Request fail."),console.log("request:"+JSON.stringify(e)),console.log("status:"+JSON.stringify(o)),console.log("err:"+JSON.stringify(t)),"function"==typeof n&&n(e,o,t)},success:function(e){console.log("Request success"),console.log("data:"+JSON.stringify(e)),"function"==typeof o&&o(e)},complete:function(e,o){myApi.display.loading.hide(),"timeout"==o&&r.abort()}})}},(myApi=myApi||{}).storage=new function(){var t;t=window.localStorage?window.localStorage:require("./cookie.js")(),this.setItem=function(e,o){t.setItem(e,o)},this.getItem=function(e){var o=t.getItem(e);return void 0===o||null==o?"":o},this.removeItem=function(e){t.removeItem(e)},this.clear=function(){t.clear()}},(myApi=myApi||{}).string={init:function(){console.log("Initialize myapi string library."),this.trim()},trim:function(){console.log("Add trim routines."),"function"!=typeof String.trim&&(String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")}),"function"!=typeof String.ltrim&&(String.prototype.ltrim=function(){return this.replace(/(^\s*)/g,"")}),"function"!=typeof String.rtrim&&(String.prototype.rtrim=function(){return this.replace(/(\s*$)/g,"")})}},(myApi=myApi||{}).time={formatDuration:function(e){if(console.log("Format duration:"+e),"number"!=typeof e)return"";if(e<0)return"";var o=e,t=(o-o%3600)/3600,n=((o-=3600*t)-o%60)/60,i="";return 0<t&&(i+=t+"时"),(0<n||0<t)&&(i+=n+"分"),i+=(o-=60*n)+"秒"},formatTime:function(e){if(null==e)return"";if(isNaN(e))return"";var o="";return o+=e.getFullYear(),o+="-",o+=$.trim(""+(e.getMonth()+1)).length<2?"0"+(e.getMonth()+1):e.getMonth()+1,o+="-",o+=$.trim(""+e.getDate()).length<2?"0"+e.getDate():e.getDate(),o+=" ",o+=$.trim(""+e.getHours()).length<2?"0"+e.getHours():e.getHours(),o+=":",o+=$.trim(""+e.getMinutes()).length<2?"0"+e.getMinutes():e.getMinutes()},formatDateString:function(e,o){if(console.log("Format date string"),console.log("dateString:"+e),console.log("sep:"+o),"string"!=typeof e||8!=e.trim().length)return"";var t=e.trim(),n="-";"string"==typeof o&&0<o.trim().length&&(n=o.trim());var i="";return i+=t.substring(0,4),i+=n+t.substring(4,6),i+=n+t.substring(6,8)},formatDate:function(e,o){var t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),r=void 0===o?"-":o;return t+r+(n<10?"0"+n:n)+r+(i<10?"0"+i:i)},addSeconds:function(e,o){if(null==e)return null;if(isNaN(e))return null;if(null==o)return null;if(isNaN(o))return null;var t=e.getTime(),n=new Date;return n.setTime(t+1e3*o),n},addDays:function(e,o){var t=e.getTime(),n=new Date;return n.setTime(t+24*o*3600*1e3),n}},(myApi=myApi||{}).wx={init:function(e,o,t){console.log("Initialize wx api."),console.log("param:"+JSON.stringify(e));var n=!1;wx.config({debug:!1,appId:e.appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["chooseWXPay","chooseImage","uploadImage","scanQRCode"]}),wx.ready(function(){console.log("JSAPI ready."),0==n&&"function"==typeof o&&o()}),wx.error(function(e){console.log("JSAPI initialize fail."),n=!0,"function"==typeof t&&t()})},scan:function(o,t){console.log("Scan"),wx.checkJsApi({jsApiList:["scanQRCode"],success:function(e){if(console.log("res:"+JSON.stringify(e)),e.errMsg.indexOf("ok")<0)return console.log("Error occurred:"+e.errMsg),void("function"==typeof t&&t("扫描功能检测失败"));1==e.checkResult.scanQRCode?(console.log("Scan qr code allowed."),wx.scanQRCode({needResult:1,scanType:["qrCode","barCode"],success:function(e){if(console.log("scan res:"+JSON.stringify(e)),e.errMsg.indexOf("ok")<0)return console.log("Error occurred while scan:"+e.errMsg),void("function"==typeof t&&t("扫描功能未获授权"));console.log("scan success"),"function"==typeof o&&o(e.resultStr)}})):(console.log("Scan qr code no allowed."),"function"==typeof t&&t("扫描功能未获授权"))}})}},(myApi=myApi||{}).display=myApi.display||{},myApi.display.loading={show:function(){console.log("Show loading."),this.hide();var e=document.createElement("div");e.setAttribute("class","myApi-loading"),document.body.appendChild(e)},hide:function(){console.log("Hide loading.");try{document.body.removeChild(document.querySelector("div.myApi-loading"))}catch(e){}}};